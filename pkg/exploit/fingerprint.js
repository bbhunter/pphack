/*
pphack - The Most Advanced Client-Side Prototype Pollution Scanner

This repository is under MIT License https://github.com/edoardottt/pphack/blob/main/LICENSE

Credits:
    - https://gist.github.com/nikitastupin/b3b64a9f8c0eb74ce37626860193eaec
    - https://github.com/BlackFan/client-side-prototype-pollution/tree/master/fingerprint
*/

(() => {
    let fingerprint = [];
    
    if (typeof _satellite !== 'undefined') {
        fingerprint.push('Adobe Dynamic Tag Management');
    }
  
    if (typeof BOOMR !== 'undefined') {
        fingerprint.push('Akamai Boomerang');
    }

    if (typeof _analytics !== 'undefined' && typeof analyticsGtagManager !== 'undefined') {
        fingerprint.push('Google Tag Manager plugin for analytics');
    }
  
    if (typeof goog !== 'undefined' && typeof goog.basePath !== 'undefined') {
        fingerprint.push('Closure');
    }

    if (typeof Demandbase != 'undefined') {
        fingerprint.push('Demandbase');
    }
  
    if (typeof DOMPurify !== 'undefined') {
        fingerprint.push('DOMPurify');
    }
  
    if (typeof window.embedly !== 'undefined') {
        fingerprint.push('Embedly Cards');
    }

    if (typeof GoogleAnalyticsObject !== 'undefined') {
        fingerprint.push('Google Analytics');
    }

    if (typeof google_tag_manager !== 'undefined') {
        fingerprint.push('Google Tag Manager');
    }

    if (typeof hcaptcha !== 'undefined') {
        fingerprint.push('hCaptcha');
    }

    if (typeof i18next !== 'undefined') {
        fingerprint.push('i18next');
    }
  
    if (typeof $ !== 'undefined' && typeof $.fn !== 'undefined' && typeof $.fn.jquery !== 'undefined') {
        fingerprint.push('jQuery');
    }
  
    if (typeof filterXSS !== 'undefined') {
        fingerprint.push('js-xss');
    }
  
    if (typeof ko !== 'undefined' && typeof ko.version !== 'undefined') {
        fingerprint.push('Knockout.js');
    }
  
    if (typeof _ !== 'undefined' && typeof _.template !== 'undefined' && typeof _.VERSION !== 'undefined') {
        fingerprint.push('Lodash <= 4.17.15');
    }
  
    if (typeof Marionette !== 'undefined') {
        fingerprint.push('Marionette.js');
    }

    if (typeof Backbone !== 'undefined' && typeof Backbone.VERSION !== 'undefined') {
        fingerprint.push('Backbone.js');
    }

    if (typeof pendo !== 'undefined') {
        fingerprint.push('Pendo Agent');
    }

    if (typeof Popper !== 'undefined') {
        fingerprint.push('Popper.js');
    }
  
    if (typeof recaptcha !== 'undefined') {
        fingerprint.push('Google reCAPTCHA');
    }
  
    if (typeof sanitizeHtml !== 'undefined') {
        fingerprint.push('sanitize-html');
    }

    if (typeof Scriptaculous !== 'undefined') {
        fingerprint.push('script.aculo.us');
    }
  
    if (typeof analytics !== 'undefined' && typeof analytics.SNIPPET_VERSION !== 'undefined') {
        fingerprint.push('Segment Analytics.js');
    }
  
    if (typeof Sprint !== 'undefined') {
        fingerprint.push('Sprint.js');
    }
  
    if (typeof SwiftypeObject != 'undefined') {
        fingerprint.push('Swiftype Site Search (uses jQuery BBQ)');
    }
  
    if (typeof utag !== 'undefined' && typeof utag.id !== 'undefined') {
        fingerprint.push('Tealium Universal Tag');
    }
  
    if (typeof twq !== 'undefined' && typeof twq.version !== 'undefined') {
        fingerprint.push('Twitter Universal Website Tag');
    }

    if (typeof Vue != 'undefined') {
        fingerprint.push('Vue.js');
    }
  
    if (typeof wistiaEmbeds !== 'undefined') {
        fingerprint.push('Wistia Embedded Video');
    }
  
    if (typeof $ !== 'undefined' && typeof $.zepto !== 'undefined') {
        fingerprint.push('Zepto.js');
    }
  
    return fingerprint;
  })();
